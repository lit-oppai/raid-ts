import{d as F,e as f,o as P,c as z,P as c,a1 as u,u as e,l as o,A as d,a5 as b}from"./index-Dv97TFdI.js";import{x as v,H as T,S as w,y as l,j as D,l as B,z as n,w as N,g as m,h as s,A,r as t,B as y,n as x,f as _,i as p,p as L,o as E}from"./controlView-tbByPEUt.js";const $={class:"space-x-4"},O=F({__name:"EstablishFooter",setup(H){const R=f(()=>v.value.map(a=>{var i,r;return((i=T.get(a+""))==null?void 0:i.path)??((r=w.get(a+""))==null?void 0:r.path)??""})??[]),h=()=>{switch(s("next"),n.value){case"CreateStorage":g();break;default:I();break}},g=()=>{b.storage.createStorage({name:x.value,path:_.value,format:!0}).then(a=>{a.status===200?(t.success=!0,t.btnText="Done"):(t.success=!1,t.btnText="Restart"),t.butFunc=m}).catch(a=>{console.log(a)}).finally(()=>{s("next")})},I=()=>{var i;const a=Number((i=D.value)==null?void 0:i.split("RAID")[1]);b.raid.createRaid({devices:R.value,name:x.value,raid_level:a}).then(r=>{t.capacity=(r.data.size??0)*1024,t.btnText="Done",t.success=!0,t.butFunc=()=>{m()}}).catch(r=>{console.log(r),t.btnText="Restart",t.success=!1,t.butFunc=()=>{s("prev"),s("prev"),s("prev"),p()}}).finally(()=>{s("next")})},S=f(()=>{if(l.value==="SelectRAIDPart")switch(D.value){case"RAID0":case"RAID1":return v.value.length<2;case"RAID5":return B.value.length?v.value.length<1:v.value.length<3}return!1}),C=()=>{s("next"),b.raid.updateRaid({devices:[y.value],path:L.value,action:"add"}).then(a=>{t.capacity=(a.data.size??0)*1024,t.btnText="Done",t.success=!0,t.butFunc=()=>{p(),m()}}).catch(a=>{console.log(a),t.btnText="Restart",t.success=!1,t.butFunc=()=>{p(),m()}}).finally(()=>{s("next")})},k=()=>{s("next"),b.raid.updateRaid({devices:R.value,path:E.value??"",action:"add"}).then(a=>{t.capacity=(a.data.size??0)*1024,t.btnText="Done",t.success=!0,t.butFunc=()=>{p(),m()}}).catch(a=>{console.log(a),t.btnText="Restart",t.success=!1,t.butFunc=()=>{p(),m()}}).finally(()=>{s("next")})};return(a,i)=>(P(),z("div",$,[c(o(e(d),{label:"Cancel",severity:"neutral",size:"medium",onClick:e(m)},null,8,["onClick"]),[[u,e(n)!=="FirstAid"&&e(l)!=="OverviewPart"&&e(n)==="Modify"&&e(N)<2]]),c(o(e(d),{label:"Previous",severity:"neutral",size:"medium",onClick:i[0]||(i[0]=r=>e(s)("prev"))},null,512),[[u,e(n)!=="FirstAid"&&e(l)!=="ResultRAIDPart"&&e(l)!=="ResultRAIDPart"]]),c(o(e(d),{label:"Next",severity:"primary",size:"medium",onClick:i[1]||(i[1]=r=>e(s)("next")),disabled:S.value},null,8,["disabled"]),[[u,e(n)!=="FirstAid"&&e(l)!=="ConfirmRAIDPart"&&e(l)!=="ResultRAIDPart"]]),c(o(e(d),{label:"创建",severity:"primary",size:"medium",onClick:h,disabled:e(n)!=="CreateStorage"&&e(v).length<2||!e(A)},null,8,["disabled"]),[[u,e(n)!=="FirstAid"&&e(l)==="ConfirmRAIDPart"]]),c(o(e(d),{label:e(t).btnText,severity:"primary",size:"medium",onClick:e(t).butFunc},null,8,["label","onClick"]),[[u,e(l)!=="AddToRAIDPart"&&e(l)==="ResultRAIDPart"]]),c(o(e(d),{label:"Add",severity:"primary",size:"medium",onClick:i[2]||(i[2]=r=>e(s)("next")),disabled:!e(y)},null,8,["disabled"]),[[u,e(l)==="AddToRAIDPart"]]),c(o(e(d),{label:"Confirm",severity:"primary",size:"medium",onClick:C,disabled:!e(A)},null,8,["disabled"]),[[u,e(n)==="FirstAid"&&e(l)==="ConfirmRAIDPart"]]),c(o(e(d),{label:"Confirm",severity:"primary",size:"medium",onClick:k,disabled:!e(A)},null,8,["disabled"]),[[u,e(n)==="Modify"&&e(l)==="ConfirmRAIDPart"]])]))}});export{O as default};
